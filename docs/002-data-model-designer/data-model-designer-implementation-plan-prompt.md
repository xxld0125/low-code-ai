# 数据模型设计器技术实现规划提示词文档

**文档用途**: `/spekit.plan` 命令专用技术实现规划生成提示词
**项目名称**: FlowBase - 全栈低代码开发平台
**功能模块**: 数据模型设计器 (002-data-model-designer)
**创建日期**: 2025-01-23
**文档版本**: v1.0

---

## 1. 命令执行上下文

### 当前项目状态

- **技术栈**: Next.js 15 + React 19 + TypeScript + Supabase
- **认证系统**: 已完成完整的用户认证功能（注册、登录、密码重置）
- **UI框架**: shadcn/ui + Tailwind CSS
- **状态管理**: Zustand
- **数据库**: Supabase PostgreSQL + RLS权限系统

### 功能分支信息

- **分支名称**: `002-data-model-designer`
- **功能状态**: 需求已定义，待实现规划
- **优先级**: P1核心功能，低代码平台基础能力

---

## 2. 技术实现规划模板

### 使用说明

将以下内容作为 `/spekit.plan` 命令的输入，系统将基于当前项目技术栈和需求文档生成详细的实现规划。

```
请基于以下上下文信息，为FlowBase低代码平台的数据模型设计器功能生成详细的技术实现规划：

## 项目技术背景
### 现有技术栈
- 前端：Next.js 15 + React 19 + TypeScript + Tailwind CSS + shadcn/ui
- 后端：Supabase (PostgreSQL + Auth + Storage + Edge Functions)
- 状态管理：Zustand
- 构建工具：Turbopack
- 认证：@supabase/ssr + 基于Cookie的会话管理

### 当前项目结构
```

/app/ # Next.js App Router
/auth/ # ✅ 已完成认证页面
/protected/ # ✅ 受保护的路由
/designer/ # 🚧 待开发的设计器页面
/api/ # API路由
/designer/ # 🚧 待开发的设计器API
/components/ # React组件
/designer/ # 🚧 待开发的设计器组件
/ui/ # ✅ 已有shadcn/ui组件
/lib/ # 工具库
/designer/ # 🚧 待开发的设计器核心逻辑
/supabase/ # ✅ 已有Supabase配置
/stores/ # Zustand状态管理
/types/ # TypeScript类型定义

```

## 功能需求概述
### 核心功能
1. **可视化数据表创建**: 通过UI界面创建数据库表
2. **字段类型支持**: 文本、数字、日期、布尔值4种基础类型
3. **字段配置**: 字段名、是否必填、默认值设置
4. **关系配置**: 简单的一对多关系配置
5. **自动生成**: Supabase数据库表结构和基础CRUD API

### 用户故事要点
- 用户可以3分钟内创建包含5个字段的数据表
- 95%的表创建操作成功率
- 自动生成API响应时间<500ms
- 新用户10分钟内完成第一个数据模型创建

## 技术约束要求
### 性能要求
- 设计器界面加载时间 < 2秒
- JavaScript包大小 < 150KB gzipped
- 数据库schema修改 < 2秒
- 实时验证响应 < 100ms

### 安全要求
- 基于Supabase RLS的权限控制
- 防止SQL注入和恶意操作
- 数据库迁移的安全回滚
- 用户项目隔离和数据安全

### 兼容性要求
- 支持现代浏览器（Chrome 88+, Firefox 85+, Safari 14+）
- 响应式设计，适配桌面端
- 符合WCAG 2.1 AA无障碍标准

## 集成要求
### 与现有系统集成
- 无缝集成现有用户认证系统
- 利用现有shadcn/ui组件库
- 遵循现有项目架构和代码规范
- 与后续页面设计器功能预留接口

### 数据库设计要求
- 基于Supabase PostgreSQL
- 支持schema版本控制和迁移
- 自动生成RLS策略
- 维护数据完整性和一致性

请生成包含以下内容的详细技术实现规划：
1. 架构设计方案
2. 数据库schema设计
3. 前端组件设计
4. API接口设计
5. 关键技术实现细节
6. 开发步骤和里程碑
7. 测试策略
8. 风险识别和应对方案
```

---

## 3. 预期输出内容

### 架构设计部分应包含

- 数据模型设计器的整体架构图
- 前后端交互流程设计
- 组件层次结构设计
- 状态管理方案

### 数据库设计部分应包含

- 数据表结构设计
- 关系模型设计
- RLS策略设计
- 迁移脚本模板

### 前端组件设计部分应包含

- 主要组件设计（表设计器、字段编辑器、关系配置器等）
- 组件交互流程
- 属性配置面板设计
- 拖拽交互设计（如适用）

### API接口设计部分应包含

- 表管理API（CRUD操作）
- 字段管理API
- 关系管理API
- Schema生成API

### 技术实现部分应包含

- Supabase DDL动态生成逻辑
- 表单验证逻辑
- 实时预览功能
- 错误处理和回滚机制

### 开发计划部分应包含

- 详细的开发步骤
- 关键里程碑
- 依赖关系识别
- 时间估算

### 测试策略部分应包含

- 单元测试范围
- 集成测试场景
- 性能测试指标
- 用户验收测试用例

### 风险管理部分应包含

- 技术风险识别
- 实现难点分析
- 应对解决方案
- 备选技术方案

---

## 4. 技术实现重点提示

### 4.1 Supabase集成要点

- 使用Supabase Migrations管理schema变更
- 利用PostgreSQL的动态DDL能力
- 实现安全的客户端数据库操作
- 集成Supabase Auth的用户项目权限

### 4.2 前端架构要点

- 采用模块化组件设计
- 实现响应式布局适配
- 优化拖拽交互性能
- 集成shadcn/ui设计系统

### 4.3 数据一致性要点

- 实现事务性操作保证
- 处理并发修改冲突
- 设计安全的回滚机制
- 维护前端与数据库schema同步

### 4.4 用户体验要点

- 实时保存和自动恢复
- 清晰的操作反馈和错误提示
- 渐进式引导用户操作
- 无障碍访问支持

---

## 5. 输出格式要求

### 文档结构

1. **执行摘要** - 简要概述技术方案
2. **架构设计** - 系统架构和设计原理
3. **详细实现** - 各模块具体实现方案
4. **开发计划** - 分阶段实施计划
5. **质量保证** - 测试和验证策略
6. **风险管理** - 风险识别和应对措施

### 代码示例要求

- 提供关键功能的TypeScript代码片段
- 包含完整的类型定义
- 遵循项目现有代码规范
- 注释清晰，便于理解

### 图表要求

- 使用Mermaid语法绘制架构图
- 提供清晰的组件关系图
- 包含数据流程图
- 标注关键技术决策点

---

## 6. 使用指南

### 执行命令

```bash
/spekit.plan [将上述模板内容粘贴为输入]
```

### 预期结果

执行后将生成一个名为 `plan.md` 的文档，包含：

- 详细的技术架构设计
- 完整的实现步骤规划
- 具体的代码示例和配置
- 明确的里程碑和验收标准
- 全面的风险识别和应对方案

### 后续使用

生成的规划文档将作为：

- 开发团队的技术指导文档
- 项目进度跟踪的基准
- 代码审查的参考标准
- 测试策略制定的依据

---

**文档结束**

_注：本提示词文档专为FlowBase项目的数据模型设计器功能定制，确保生成的技术规划与项目现有技术栈和架构完美契合。_
